{"version":3,"sources":["../src/index.ts"],"sourcesContent":["/**\n * @b0ase/supabase-types\n *\n * Shared Supabase database types and utilities.\n *\n * @packageDocumentation\n */\n\n// ============================================================================\n// Base Types\n// ============================================================================\n\n/** UUID type */\nexport type UUID = string;\n\n/** Timestamp type */\nexport type Timestamp = string;\n\n/** JSON type */\nexport type Json = string | number | boolean | null | { [key: string]: Json } | Json[];\n\n/** Database row base */\nexport interface BaseRow {\n  id: UUID;\n  created_at: Timestamp;\n  updated_at?: Timestamp;\n}\n\n/** Soft deletable row */\nexport interface SoftDeletableRow extends BaseRow {\n  deleted_at?: Timestamp | null;\n  is_deleted?: boolean;\n}\n\n// ============================================================================\n// Common Entity Types\n// ============================================================================\n\n/** User profile */\nexport interface UserProfile extends BaseRow {\n  user_id: UUID;\n  email?: string;\n  username?: string;\n  display_name?: string;\n  avatar_url?: string;\n  bio?: string;\n  website?: string;\n  wallet_address?: string;\n  handcash_handle?: string;\n  is_verified?: boolean;\n  metadata?: Json;\n}\n\n/** Organization */\nexport interface Organization extends SoftDeletableRow {\n  name: string;\n  slug: string;\n  description?: string;\n  logo_url?: string;\n  website?: string;\n  owner_id: UUID;\n  settings?: Json;\n  metadata?: Json;\n}\n\n/** Organization member */\nexport interface OrganizationMember extends BaseRow {\n  organization_id: UUID;\n  user_id: UUID;\n  role: 'owner' | 'admin' | 'member' | 'viewer';\n  permissions?: string[];\n  invited_by?: UUID;\n  joined_at?: Timestamp;\n}\n\n/** Project */\nexport interface Project extends SoftDeletableRow {\n  name: string;\n  slug: string;\n  description?: string;\n  organization_id?: UUID;\n  owner_id: UUID;\n  visibility: 'public' | 'private' | 'unlisted';\n  status: 'active' | 'archived' | 'draft';\n  settings?: Json;\n  metadata?: Json;\n}\n\n/** Token */\nexport interface Token extends BaseRow {\n  symbol: string;\n  name: string;\n  description?: string;\n  icon_url?: string;\n  total_supply: string;\n  decimals: number;\n  owner_id: UUID;\n  organization_id?: UUID;\n  contract_address?: string;\n  blockchain: 'bsv' | 'ethereum' | 'solana' | 'polygon';\n  standard: 'bsv-20' | 'brc-20' | 'erc-20' | 'spl';\n  is_verified?: boolean;\n  metadata?: Json;\n}\n\n/** Token balance */\nexport interface TokenBalance extends BaseRow {\n  token_id: UUID;\n  user_id: UUID;\n  balance: string;\n  locked_balance?: string;\n  pending_balance?: string;\n}\n\n/** Transaction */\nexport interface Transaction extends BaseRow {\n  type: 'transfer' | 'mint' | 'burn' | 'payment' | 'fee' | 'reward';\n  status: 'pending' | 'processing' | 'completed' | 'failed' | 'cancelled';\n  from_user_id?: UUID;\n  to_user_id?: UUID;\n  token_id?: UUID;\n  amount: string;\n  fee?: string;\n  txid?: string;\n  blockchain?: string;\n  description?: string;\n  metadata?: Json;\n}\n\n/** File */\nexport interface File extends SoftDeletableRow {\n  name: string;\n  path: string;\n  mime_type: string;\n  size: number;\n  owner_id: UUID;\n  organization_id?: UUID;\n  project_id?: UUID;\n  storage_provider: 'supabase' | 'ipfs' | 'arweave' | 'bsv';\n  storage_url?: string;\n  content_hash?: string;\n  is_public?: boolean;\n  metadata?: Json;\n}\n\n/** Comment */\nexport interface Comment extends SoftDeletableRow {\n  content: string;\n  user_id: UUID;\n  parent_id?: UUID;\n  entity_type: string;\n  entity_id: UUID;\n  is_edited?: boolean;\n  metadata?: Json;\n}\n\n/** Notification */\nexport interface Notification extends BaseRow {\n  user_id: UUID;\n  type: string;\n  title: string;\n  message?: string;\n  link?: string;\n  is_read?: boolean;\n  read_at?: Timestamp;\n  metadata?: Json;\n}\n\n/** Audit log */\nexport interface AuditLog extends BaseRow {\n  user_id?: UUID;\n  action: string;\n  entity_type: string;\n  entity_id: UUID;\n  old_values?: Json;\n  new_values?: Json;\n  ip_address?: string;\n  user_agent?: string;\n  metadata?: Json;\n}\n\n// ============================================================================\n// Query Types\n// ============================================================================\n\n/** Pagination params */\nexport interface PaginationParams {\n  page?: number;\n  limit?: number;\n  offset?: number;\n}\n\n/** Sort params */\nexport interface SortParams {\n  field: string;\n  direction: 'asc' | 'desc';\n}\n\n/** Filter operator */\nexport type FilterOperator =\n  | 'eq'\n  | 'neq'\n  | 'gt'\n  | 'gte'\n  | 'lt'\n  | 'lte'\n  | 'like'\n  | 'ilike'\n  | 'in'\n  | 'is'\n  | 'contains'\n  | 'overlaps';\n\n/** Filter param */\nexport interface FilterParam {\n  field: string;\n  operator: FilterOperator;\n  value: unknown;\n}\n\n/** Query params */\nexport interface QueryParams {\n  pagination?: PaginationParams;\n  sort?: SortParams[];\n  filters?: FilterParam[];\n  select?: string;\n  include?: string[];\n}\n\n/** Paginated response */\nexport interface PaginatedResponse<T> {\n  data: T[];\n  total: number;\n  page: number;\n  limit: number;\n  totalPages: number;\n  hasMore: boolean;\n}\n\n// ============================================================================\n// Realtime Types\n// ============================================================================\n\n/** Realtime event type */\nexport type RealtimeEventType = 'INSERT' | 'UPDATE' | 'DELETE';\n\n/** Realtime payload */\nexport interface RealtimePayload<T = Record<string, unknown>> {\n  eventType: RealtimeEventType;\n  new: T | null;\n  old: T | null;\n  table: string;\n  schema: string;\n  commit_timestamp: string;\n}\n\n/** Subscription config */\nexport interface SubscriptionConfig {\n  table: string;\n  schema?: string;\n  event?: RealtimeEventType | '*';\n  filter?: string;\n}\n\n// ============================================================================\n// RLS Policy Types\n// ============================================================================\n\n/** Policy action */\nexport type PolicyAction = 'SELECT' | 'INSERT' | 'UPDATE' | 'DELETE' | 'ALL';\n\n/** Policy definition */\nexport interface PolicyDefinition {\n  name: string;\n  table: string;\n  action: PolicyAction;\n  using?: string;\n  withCheck?: string;\n}\n\n// ============================================================================\n// Type Utilities\n// ============================================================================\n\n/** Insert type (omit auto-generated fields) */\nexport type Insert<T extends BaseRow> = Omit<T, 'id' | 'created_at' | 'updated_at'> & {\n  id?: UUID;\n  created_at?: Timestamp;\n  updated_at?: Timestamp;\n};\n\n/** Update type (all fields optional except id) */\nexport type Update<T extends BaseRow> = Partial<Omit<T, 'id' | 'created_at'>> & {\n  updated_at?: Timestamp;\n};\n\n/** Row type with relations */\nexport type WithRelations<T, Relations extends Record<string, unknown>> = T & {\n  [K in keyof Relations]?: Relations[K];\n};\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\nexport function buildPaginatedResponse<T>(\n  data: T[],\n  total: number,\n  params: PaginationParams\n): PaginatedResponse<T> {\n  const page = params.page || 1;\n  const limit = params.limit || 10;\n  const totalPages = Math.ceil(total / limit);\n\n  return {\n    data,\n    total,\n    page,\n    limit,\n    totalPages,\n    hasMore: page < totalPages,\n  };\n}\n\nexport function calculateOffset(page: number, limit: number): number {\n  return (page - 1) * limit;\n}\n\nexport function parseSortString(sort: string): SortParams[] {\n  return sort.split(',').map(s => {\n    const [field, direction] = s.trim().split(':');\n    return {\n      field: field.trim(),\n      direction: (direction?.trim().toLowerCase() === 'desc' ? 'desc' : 'asc') as 'asc' | 'desc',\n    };\n  });\n}\n\nexport function toSnakeCase(str: string): string {\n  return str.replace(/[A-Z]/g, letter => `_${letter.toLowerCase()}`);\n}\n\nexport function toCamelCase(str: string): string {\n  return str.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n}\n\nexport function transformKeys<T extends Record<string, unknown>>(\n  obj: T,\n  transformer: (key: string) => string\n): Record<string, unknown> {\n  const result: Record<string, unknown> = {};\n  for (const key of Object.keys(obj)) {\n    result[transformer(key)] = obj[key];\n  }\n  return result;\n}\n\nexport function snakeCaseKeys<T extends Record<string, unknown>>(obj: T): Record<string, unknown> {\n  return transformKeys(obj, toSnakeCase);\n}\n\nexport function camelCaseKeys<T extends Record<string, unknown>>(obj: T): Record<string, unknown> {\n  return transformKeys(obj, toCamelCase);\n}\n\nexport function isUUID(str: string): boolean {\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n  return uuidRegex.test(str);\n}\n\nexport function generateSlug(name: string): string {\n  return name\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-|-$/g, '');\n}\n\nexport function parseTimestamp(timestamp: Timestamp): Date {\n  return new Date(timestamp);\n}\n\nexport function toTimestamp(date: Date): Timestamp {\n  return date.toISOString();\n}\n"],"mappings":";AAiTO,SAAS,uBACd,MACA,OACA,QACsB;AACtB,QAAM,OAAO,OAAO,QAAQ;AAC5B,QAAM,QAAQ,OAAO,SAAS;AAC9B,QAAM,aAAa,KAAK,KAAK,QAAQ,KAAK;AAE1C,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,SAAS,OAAO;AAAA,EAClB;AACF;AAEO,SAAS,gBAAgB,MAAc,OAAuB;AACnE,UAAQ,OAAO,KAAK;AACtB;AAEO,SAAS,gBAAgB,MAA4B;AAC1D,SAAO,KAAK,MAAM,GAAG,EAAE,IAAI,OAAK;AAC9B,UAAM,CAAC,OAAO,SAAS,IAAI,EAAE,KAAK,EAAE,MAAM,GAAG;AAC7C,WAAO;AAAA,MACL,OAAO,MAAM,KAAK;AAAA,MAClB,WAAY,WAAW,KAAK,EAAE,YAAY,MAAM,SAAS,SAAS;AAAA,IACpE;AAAA,EACF,CAAC;AACH;AAEO,SAAS,YAAY,KAAqB;AAC/C,SAAO,IAAI,QAAQ,UAAU,YAAU,IAAI,OAAO,YAAY,CAAC,EAAE;AACnE;AAEO,SAAS,YAAY,KAAqB;AAC/C,SAAO,IAAI,QAAQ,aAAa,CAAC,GAAG,WAAW,OAAO,YAAY,CAAC;AACrE;AAEO,SAAS,cACd,KACA,aACyB;AACzB,QAAM,SAAkC,CAAC;AACzC,aAAW,OAAO,OAAO,KAAK,GAAG,GAAG;AAClC,WAAO,YAAY,GAAG,CAAC,IAAI,IAAI,GAAG;AAAA,EACpC;AACA,SAAO;AACT;AAEO,SAAS,cAAiD,KAAiC;AAChG,SAAO,cAAc,KAAK,WAAW;AACvC;AAEO,SAAS,cAAiD,KAAiC;AAChG,SAAO,cAAc,KAAK,WAAW;AACvC;AAEO,SAAS,OAAO,KAAsB;AAC3C,QAAM,YAAY;AAClB,SAAO,UAAU,KAAK,GAAG;AAC3B;AAEO,SAAS,aAAa,MAAsB;AACjD,SAAO,KACJ,YAAY,EACZ,QAAQ,eAAe,GAAG,EAC1B,QAAQ,UAAU,EAAE;AACzB;AAEO,SAAS,eAAe,WAA4B;AACzD,SAAO,IAAI,KAAK,SAAS;AAC3B;AAEO,SAAS,YAAY,MAAuB;AACjD,SAAO,KAAK,YAAY;AAC1B;","names":[]}