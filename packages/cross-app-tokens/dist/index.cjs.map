{"version":3,"sources":["../src/index.ts"],"sourcesContent":["/**\n * @b0ase/cross-app-tokens\n *\n * Cross-app token recognition, portability, and verification.\n *\n * @packageDocumentation\n */\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/** Token standard */\nexport type TokenStandard =\n  | 'bsv-20'\n  | 'bsv-21'\n  | 'brc-20'\n  | 'erc-20'\n  | 'erc-721'\n  | 'erc-1155'\n  | 'spl'\n  | 'metaplex'\n  | 'ordinals'\n  | 'custom';\n\n/** Token type */\nexport type TokenType = 'fungible' | 'non-fungible' | 'semi-fungible';\n\n/** Blockchain */\nexport type Blockchain = 'bsv' | 'bitcoin' | 'ethereum' | 'solana' | 'polygon' | 'base';\n\n/** Verification status */\nexport type VerificationStatus =\n  | 'unverified'\n  | 'pending'\n  | 'verified'\n  | 'trusted'\n  | 'revoked';\n\n/** Cross-app token */\nexport interface CrossAppToken {\n  id: string;\n  symbol: string;\n  name: string;\n  standard: TokenStandard;\n  type: TokenType;\n  blockchain: Blockchain;\n  contractAddress?: string;\n  inscriptionId?: string;\n  decimals: number;\n  totalSupply?: bigint;\n  issuer: TokenIssuer;\n  metadata: TokenMetadata;\n  verification: TokenVerification;\n  apps: AppRegistration[];\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n/** Token issuer */\nexport interface TokenIssuer {\n  id: string;\n  name: string;\n  domain?: string;\n  publicKey?: string;\n  verified: boolean;\n}\n\n/** Token metadata */\nexport interface TokenMetadata {\n  description?: string;\n  image?: string;\n  externalUrl?: string;\n  attributes?: TokenAttribute[];\n  properties?: Record<string, unknown>;\n}\n\n/** Token attribute */\nexport interface TokenAttribute {\n  trait_type: string;\n  value: string | number;\n  display_type?: 'string' | 'number' | 'date' | 'boost_number' | 'boost_percentage';\n}\n\n/** Token verification */\nexport interface TokenVerification {\n  status: VerificationStatus;\n  verifiedAt?: Date;\n  verifiedBy?: string;\n  signature?: string;\n  proofUrl?: string;\n  expiresAt?: Date;\n}\n\n/** App registration */\nexport interface AppRegistration {\n  appId: string;\n  appName: string;\n  domain: string;\n  registeredAt: Date;\n  permissions: AppPermission[];\n  status: 'active' | 'suspended' | 'revoked';\n  callbackUrl?: string;\n}\n\n/** App permission */\nexport type AppPermission =\n  | 'read'\n  | 'transfer'\n  | 'burn'\n  | 'mint'\n  | 'metadata'\n  | 'admin';\n\n/** Token balance */\nexport interface TokenBalance {\n  token: CrossAppToken;\n  balance: bigint;\n  locked?: bigint;\n  pending?: bigint;\n  lastUpdated: Date;\n}\n\n/** Transfer request */\nexport interface TransferRequest {\n  id: string;\n  tokenId: string;\n  fromAddress: string;\n  toAddress: string;\n  amount: bigint;\n  sourceApp: string;\n  targetApp?: string;\n  status: TransferStatus;\n  txid?: string;\n  createdAt: Date;\n  completedAt?: Date;\n}\n\n/** Transfer status */\nexport type TransferStatus =\n  | 'pending'\n  | 'processing'\n  | 'completed'\n  | 'failed'\n  | 'cancelled';\n\n/** Portable token format (for cross-app transfers) */\nexport interface PortableToken {\n  version: '1.0';\n  token: {\n    id: string;\n    symbol: string;\n    name: string;\n    standard: TokenStandard;\n    blockchain: Blockchain;\n    contract?: string;\n  };\n  holder: {\n    address: string;\n    signature: string;\n  };\n  amount: string;\n  nonce: string;\n  timestamp: number;\n  sourceApp: string;\n  proof: string;\n}\n\n// ============================================================================\n// Token Registry\n// ============================================================================\n\nexport class TokenRegistry {\n  private tokens: Map<string, CrossAppToken> = new Map();\n  private appTokens: Map<string, Set<string>> = new Map();\n  private verificationCallbacks: Map<string, (token: CrossAppToken) => Promise<boolean>> = new Map();\n\n  registerToken(token: CrossAppToken): void {\n    this.tokens.set(token.id, token);\n\n    // Index by apps\n    for (const app of token.apps) {\n      if (!this.appTokens.has(app.appId)) {\n        this.appTokens.set(app.appId, new Set());\n      }\n      this.appTokens.get(app.appId)!.add(token.id);\n    }\n  }\n\n  getToken(id: string): CrossAppToken | undefined {\n    return this.tokens.get(id);\n  }\n\n  getTokenBySymbol(symbol: string, blockchain?: Blockchain): CrossAppToken | undefined {\n    for (const token of this.tokens.values()) {\n      if (token.symbol.toLowerCase() === symbol.toLowerCase()) {\n        if (!blockchain || token.blockchain === blockchain) {\n          return token;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  getTokenByContract(address: string, blockchain: Blockchain): CrossAppToken | undefined {\n    for (const token of this.tokens.values()) {\n      if (\n        token.blockchain === blockchain &&\n        token.contractAddress?.toLowerCase() === address.toLowerCase()\n      ) {\n        return token;\n      }\n    }\n    return undefined;\n  }\n\n  getTokensForApp(appId: string): CrossAppToken[] {\n    const tokenIds = this.appTokens.get(appId);\n    if (!tokenIds) return [];\n\n    return Array.from(tokenIds)\n      .map(id => this.tokens.get(id))\n      .filter((t): t is CrossAppToken => !!t);\n  }\n\n  getTokensByBlockchain(blockchain: Blockchain): CrossAppToken[] {\n    return Array.from(this.tokens.values()).filter(t => t.blockchain === blockchain);\n  }\n\n  getVerifiedTokens(): CrossAppToken[] {\n    return Array.from(this.tokens.values()).filter(\n      t => t.verification.status === 'verified' || t.verification.status === 'trusted'\n    );\n  }\n\n  registerApp(tokenId: string, app: AppRegistration): void {\n    const token = this.tokens.get(tokenId);\n    if (!token) {\n      throw new Error(`Token not found: ${tokenId}`);\n    }\n\n    const existingIndex = token.apps.findIndex(a => a.appId === app.appId);\n    if (existingIndex >= 0) {\n      token.apps[existingIndex] = app;\n    } else {\n      token.apps.push(app);\n    }\n\n    if (!this.appTokens.has(app.appId)) {\n      this.appTokens.set(app.appId, new Set());\n    }\n    this.appTokens.get(app.appId)!.add(tokenId);\n\n    token.updatedAt = new Date();\n  }\n\n  revokeApp(tokenId: string, appId: string): void {\n    const token = this.tokens.get(tokenId);\n    if (!token) return;\n\n    const app = token.apps.find(a => a.appId === appId);\n    if (app) {\n      app.status = 'revoked';\n      token.updatedAt = new Date();\n    }\n  }\n\n  setVerificationCallback(\n    standard: TokenStandard,\n    callback: (token: CrossAppToken) => Promise<boolean>\n  ): void {\n    this.verificationCallbacks.set(standard, callback);\n  }\n\n  async verifyToken(tokenId: string): Promise<boolean> {\n    const token = this.tokens.get(tokenId);\n    if (!token) return false;\n\n    const callback = this.verificationCallbacks.get(token.standard);\n    if (!callback) {\n      // No custom verification, mark as pending\n      token.verification.status = 'pending';\n      token.updatedAt = new Date();\n      return true;\n    }\n\n    try {\n      const verified = await callback(token);\n      token.verification.status = verified ? 'verified' : 'unverified';\n      token.verification.verifiedAt = verified ? new Date() : undefined;\n      token.updatedAt = new Date();\n      return verified;\n    } catch {\n      token.verification.status = 'unverified';\n      token.updatedAt = new Date();\n      return false;\n    }\n  }\n\n  getAllTokens(): CrossAppToken[] {\n    return Array.from(this.tokens.values());\n  }\n\n  getStats(): {\n    total: number;\n    byBlockchain: Record<Blockchain, number>;\n    byStandard: Record<TokenStandard, number>;\n    verified: number;\n  } {\n    const tokens = this.getAllTokens();\n    const byBlockchain: Record<string, number> = {};\n    const byStandard: Record<string, number> = {};\n    let verified = 0;\n\n    for (const token of tokens) {\n      byBlockchain[token.blockchain] = (byBlockchain[token.blockchain] || 0) + 1;\n      byStandard[token.standard] = (byStandard[token.standard] || 0) + 1;\n      if (token.verification.status === 'verified' || token.verification.status === 'trusted') {\n        verified++;\n      }\n    }\n\n    return {\n      total: tokens.length,\n      byBlockchain: byBlockchain as Record<Blockchain, number>,\n      byStandard: byStandard as Record<TokenStandard, number>,\n      verified,\n    };\n  }\n}\n\n// ============================================================================\n// Portable Token Manager\n// ============================================================================\n\nexport class PortableTokenManager {\n  private registry: TokenRegistry;\n\n  constructor(registry: TokenRegistry) {\n    this.registry = registry;\n  }\n\n  createPortableToken(\n    tokenId: string,\n    holderAddress: string,\n    amount: bigint,\n    sourceApp: string,\n    signCallback: (message: string) => Promise<string>\n  ): Promise<PortableToken> {\n    const token = this.registry.getToken(tokenId);\n    if (!token) {\n      throw new Error(`Token not found: ${tokenId}`);\n    }\n\n    const nonce = this.generateNonce();\n    const timestamp = Date.now();\n    const message = this.createSignatureMessage(token, holderAddress, amount, nonce, timestamp);\n\n    return signCallback(message).then(signature => {\n      const proof = this.createProof(token, holderAddress, amount, nonce, timestamp, signature);\n\n      return {\n        version: '1.0',\n        token: {\n          id: token.id,\n          symbol: token.symbol,\n          name: token.name,\n          standard: token.standard,\n          blockchain: token.blockchain,\n          contract: token.contractAddress,\n        },\n        holder: {\n          address: holderAddress,\n          signature,\n        },\n        amount: amount.toString(),\n        nonce,\n        timestamp,\n        sourceApp,\n        proof,\n      };\n    });\n  }\n\n  verifyPortableToken(portable: PortableToken): boolean {\n    // Check version\n    if (portable.version !== '1.0') {\n      return false;\n    }\n\n    // Check timestamp (not too old - 5 minutes)\n    const age = Date.now() - portable.timestamp;\n    if (age > 5 * 60 * 1000) {\n      return false;\n    }\n\n    // Verify token exists in registry\n    const token = this.registry.getToken(portable.token.id);\n    if (!token) {\n      return false;\n    }\n\n    // Verify proof\n    const expectedProof = this.createProof(\n      token,\n      portable.holder.address,\n      BigInt(portable.amount),\n      portable.nonce,\n      portable.timestamp,\n      portable.holder.signature\n    );\n\n    return expectedProof === portable.proof;\n  }\n\n  importPortableToken(portable: PortableToken, targetApp: string): CrossAppToken | null {\n    if (!this.verifyPortableToken(portable)) {\n      return null;\n    }\n\n    const token = this.registry.getToken(portable.token.id);\n    if (!token) {\n      return null;\n    }\n\n    // Check if target app is registered\n    const appReg = token.apps.find(a => a.appId === targetApp);\n    if (!appReg || appReg.status !== 'active') {\n      // Register the app with read permission\n      this.registry.registerApp(token.id, {\n        appId: targetApp,\n        appName: targetApp,\n        domain: targetApp,\n        registeredAt: new Date(),\n        permissions: ['read'],\n        status: 'active',\n      });\n    }\n\n    return token;\n  }\n\n  private generateNonce(): string {\n    const array = new Uint8Array(16);\n    for (let i = 0; i < array.length; i++) {\n      array[i] = Math.floor(Math.random() * 256);\n    }\n    return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');\n  }\n\n  private createSignatureMessage(\n    token: CrossAppToken,\n    address: string,\n    amount: bigint,\n    nonce: string,\n    timestamp: number\n  ): string {\n    return [\n      `Cross-App Token Transfer`,\n      `Token: ${token.symbol} (${token.id})`,\n      `Amount: ${amount.toString()}`,\n      `Holder: ${address}`,\n      `Nonce: ${nonce}`,\n      `Timestamp: ${timestamp}`,\n    ].join('\\n');\n  }\n\n  private createProof(\n    token: CrossAppToken,\n    address: string,\n    amount: bigint,\n    nonce: string,\n    timestamp: number,\n    signature: string\n  ): string {\n    // Simple proof hash (real implementation would use crypto)\n    const data = `${token.id}:${address}:${amount}:${nonce}:${timestamp}:${signature}`;\n    let hash = 0;\n    for (let i = 0; i < data.length; i++) {\n      const char = data.charCodeAt(i);\n      hash = ((hash << 5) - hash) + char;\n      hash = hash & hash;\n    }\n    return `proof_${Math.abs(hash).toString(16)}`;\n  }\n}\n\n// ============================================================================\n// Factory Functions\n// ============================================================================\n\nexport function createTokenRegistry(): TokenRegistry {\n  return new TokenRegistry();\n}\n\nexport function createPortableTokenManager(registry: TokenRegistry): PortableTokenManager {\n  return new PortableTokenManager(registry);\n}\n\nexport function createToken(input: {\n  symbol: string;\n  name: string;\n  standard: TokenStandard;\n  type: TokenType;\n  blockchain: Blockchain;\n  contractAddress?: string;\n  inscriptionId?: string;\n  decimals?: number;\n  totalSupply?: bigint;\n  issuer: Omit<TokenIssuer, 'verified'>;\n  metadata?: Partial<TokenMetadata>;\n}): CrossAppToken {\n  const id = `token-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  const now = new Date();\n\n  return {\n    id,\n    symbol: input.symbol,\n    name: input.name,\n    standard: input.standard,\n    type: input.type,\n    blockchain: input.blockchain,\n    contractAddress: input.contractAddress,\n    inscriptionId: input.inscriptionId,\n    decimals: input.decimals ?? (input.type === 'fungible' ? 8 : 0),\n    totalSupply: input.totalSupply,\n    issuer: {\n      ...input.issuer,\n      verified: false,\n    },\n    metadata: {\n      ...input.metadata,\n    },\n    verification: {\n      status: 'unverified',\n    },\n    apps: [],\n    createdAt: now,\n    updatedAt: now,\n  };\n}\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\nexport function getStandardForBlockchain(blockchain: Blockchain): TokenStandard[] {\n  const standards: Record<Blockchain, TokenStandard[]> = {\n    bsv: ['bsv-20', 'bsv-21', 'ordinals'],\n    bitcoin: ['brc-20', 'ordinals'],\n    ethereum: ['erc-20', 'erc-721', 'erc-1155'],\n    solana: ['spl', 'metaplex'],\n    polygon: ['erc-20', 'erc-721', 'erc-1155'],\n    base: ['erc-20', 'erc-721', 'erc-1155'],\n  };\n  return standards[blockchain] || [];\n}\n\nexport function isNFTStandard(standard: TokenStandard): boolean {\n  return ['erc-721', 'erc-1155', 'metaplex', 'ordinals', 'bsv-21'].includes(standard);\n}\n\nexport function isFungibleStandard(standard: TokenStandard): boolean {\n  return ['bsv-20', 'brc-20', 'erc-20', 'spl'].includes(standard);\n}\n\nexport function formatTokenAmount(amount: bigint, decimals: number): string {\n  const divisor = BigInt(10 ** decimals);\n  const whole = amount / divisor;\n  const fraction = amount % divisor;\n\n  if (fraction === BigInt(0)) {\n    return whole.toString();\n  }\n\n  const fractionStr = fraction.toString().padStart(decimals, '0');\n  const trimmedFraction = fractionStr.replace(/0+$/, '');\n  return `${whole}.${trimmedFraction}`;\n}\n\nexport function parseTokenAmount(amount: string, decimals: number): bigint {\n  const [whole, fraction = ''] = amount.split('.');\n  const paddedFraction = fraction.padEnd(decimals, '0').slice(0, decimals);\n  return BigInt(whole + paddedFraction);\n}\n\nexport function getBlockchainExplorer(blockchain: Blockchain): string {\n  const explorers: Record<Blockchain, string> = {\n    bsv: 'https://whatsonchain.com',\n    bitcoin: 'https://mempool.space',\n    ethereum: 'https://etherscan.io',\n    solana: 'https://solscan.io',\n    polygon: 'https://polygonscan.com',\n    base: 'https://basescan.org',\n  };\n  return explorers[blockchain];\n}\n\nexport function getTokenUrl(token: CrossAppToken): string | undefined {\n  const explorer = getBlockchainExplorer(token.blockchain);\n\n  if (token.contractAddress) {\n    if (token.blockchain === 'ethereum' || token.blockchain === 'polygon' || token.blockchain === 'base') {\n      return `${explorer}/token/${token.contractAddress}`;\n    }\n    if (token.blockchain === 'solana') {\n      return `${explorer}/token/${token.contractAddress}`;\n    }\n  }\n\n  if (token.inscriptionId) {\n    if (token.blockchain === 'bsv') {\n      return `${explorer}/tx/${token.inscriptionId}`;\n    }\n    if (token.blockchain === 'bitcoin') {\n      return `https://ordinals.com/inscription/${token.inscriptionId}`;\n    }\n  }\n\n  return undefined;\n}\n"],"mappings":"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","names":[]}