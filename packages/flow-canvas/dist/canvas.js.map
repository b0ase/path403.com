{"version":3,"sources":["../src/canvas.tsx"],"sourcesContent":["'use client';\n\n/**\n * @b0ase/flow-canvas - Canvas Component\n *\n * SVG-based workflow canvas with nodes, connections, and drag-drop support.\n */\n\nimport React, {\n  useRef,\n  useState,\n  useCallback,\n  useEffect,\n  MouseEvent,\n  TouchEvent,\n} from 'react';\nimport type {\n  FlowCanvasProps,\n  FlowNode,\n  Connection,\n  NodeTypeDefinition,\n  Point,\n  CanvasTool,\n} from './types';\n\n// ============================================================================\n// Styles\n// ============================================================================\n\nconst defaultNodeColors: Record<string, string> = {\n  payment: '#eab308',\n  contract: '#3b82f6',\n  task: '#22c55e',\n  decision: '#a855f7',\n  milestone: '#6366f1',\n  team: '#ec4899',\n  organization: '#06b6d4',\n  role: '#f97316',\n  member: '#84cc16',\n  api: '#8b5cf6',\n  webhook: '#14b8a6',\n  condition: '#f59e0b',\n  default: '#6b7280',\n};\n\nconst connectionColors: Record<string, string> = {\n  default: 'stroke-gray-400',\n  success: 'stroke-green-400',\n  failure: 'stroke-red-400',\n  conditional: 'stroke-purple-400',\n  payment: 'stroke-yellow-400',\n  task: 'stroke-blue-400',\n};\n\nconst statusColors: Record<string, string> = {\n  pending: 'bg-yellow-400',\n  active: 'bg-green-400',\n  completed: 'bg-blue-400',\n  failed: 'bg-red-400',\n  paused: 'bg-gray-400',\n};\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\nfunction getNodeColor<T extends string>(\n  type: T,\n  nodeTypes: NodeTypeDefinition<T>[]\n): string {\n  const def = nodeTypes.find((n) => n.type === type);\n  return def?.color || defaultNodeColors[type] || defaultNodeColors.default;\n}\n\nfunction getConnectionColor(type: string): string {\n  return connectionColors[type] || connectionColors.default;\n}\n\nfunction getStatusColor(status: string): string {\n  return statusColors[status] || statusColors.pending;\n}\n\nfunction snapToGrid(value: number, gridSize: number, enabled: boolean): number {\n  if (!enabled) return value;\n  return Math.round(value / gridSize) * gridSize;\n}\n\n// ============================================================================\n// Canvas Component\n// ============================================================================\n\n/**\n * Flow Canvas\n *\n * A draggable, zoomable canvas for rendering workflow diagrams.\n *\n * @example\n * ```tsx\n * import { FlowCanvas, useFlowCanvas } from '@b0ase/flow-canvas';\n *\n * function WorkflowEditor() {\n *   const { state, nodeTypes, handlers } = useFlowCanvas();\n *\n *   return (\n *     <FlowCanvas\n *       state={state}\n *       nodeTypes={nodeTypes}\n *       handlers={handlers}\n *     />\n *   );\n * }\n * ```\n */\nexport function FlowCanvas<T extends string = string>({\n  state,\n  nodeTypes,\n  handlers,\n  renderNode,\n  renderConnection,\n  isMobile = false,\n  className = '',\n}: FlowCanvasProps<T>) {\n  const canvasRef = useRef<HTMLDivElement>(null);\n  const [isPanning, setIsPanning] = useState(false);\n  const [panStart, setPanStart] = useState<Point | null>(null);\n  const [dragStart, setDragStart] = useState<Point | null>(null);\n  const [dragOffset, setDragOffset] = useState<Point | null>(null);\n\n  // Get node position helper\n  const getNodePosition = useCallback(\n    (id: string): FlowNode<T> | undefined => {\n      return state.nodes.find((n) => n.id === id);\n    },\n    [state.nodes]\n  );\n\n  // Mouse handlers\n  const handleMouseDown = useCallback(\n    (e: MouseEvent) => {\n      if (e.button !== 0) return; // Only left click\n\n      const rect = canvasRef.current?.getBoundingClientRect();\n      if (!rect) return;\n\n      const x = (e.clientX - rect.left - state.offset.x) / state.scale;\n      const y = (e.clientY - rect.top - state.offset.y) / state.scale;\n\n      // Start panning if pan tool or clicking empty space with select tool\n      if (state.tool === 'pan' || (state.tool === 'select' && e.target === e.currentTarget)) {\n        setIsPanning(true);\n        setPanStart({ x: e.clientX - state.offset.x, y: e.clientY - state.offset.y });\n      }\n    },\n    [state.tool, state.offset, state.scale]\n  );\n\n  const handleMouseMove = useCallback(\n    (e: MouseEvent) => {\n      if (isPanning && panStart) {\n        const newOffset = {\n          x: e.clientX - panStart.x,\n          y: e.clientY - panStart.y,\n        };\n        handlers.onCanvasPan?.(newOffset);\n      }\n\n      if (state.dragging && dragStart && dragOffset) {\n        const rect = canvasRef.current?.getBoundingClientRect();\n        if (!rect) return;\n\n        const x = (e.clientX - rect.left - state.offset.x) / state.scale - dragOffset.x;\n        const y = (e.clientY - rect.top - state.offset.y) / state.scale - dragOffset.y;\n\n        const snappedX = snapToGrid(x, state.gridSize, state.gridSnap);\n        const snappedY = snapToGrid(y, state.gridSize, state.gridSnap);\n\n        handlers.onNodeUpdate?.(state.dragging, { x: snappedX, y: snappedY });\n      }\n    },\n    [\n      isPanning,\n      panStart,\n      state.dragging,\n      dragStart,\n      dragOffset,\n      state.offset,\n      state.scale,\n      state.gridSize,\n      state.gridSnap,\n      handlers,\n    ]\n  );\n\n  const handleMouseUp = useCallback(() => {\n    setIsPanning(false);\n    setPanStart(null);\n    setDragStart(null);\n    setDragOffset(null);\n  }, []);\n\n  // Node mouse handlers\n  const handleNodeMouseDown = useCallback(\n    (e: MouseEvent, nodeId: string) => {\n      e.stopPropagation();\n\n      const rect = canvasRef.current?.getBoundingClientRect();\n      if (!rect) return;\n\n      const node = state.nodes.find((n) => n.id === nodeId);\n      if (!node) return;\n\n      const clientX = (e.clientX - rect.left - state.offset.x) / state.scale;\n      const clientY = (e.clientY - rect.top - state.offset.y) / state.scale;\n\n      if (state.tool === 'delete') {\n        handlers.onNodeDelete?.(nodeId);\n        return;\n      }\n\n      if (state.tool === 'connect') {\n        if (state.connectingFrom) {\n          handlers.onConnectionAdd?.(state.connectingFrom, nodeId);\n        } else {\n          // Start connecting (handled by parent)\n          handlers.onNodeSelect?.([nodeId]);\n        }\n        return;\n      }\n\n      if (state.tool === 'select') {\n        // Multi-select with ctrl/cmd\n        if (e.ctrlKey || e.metaKey) {\n          const isSelected = state.selectedNodes.includes(nodeId);\n          const newSelection = isSelected\n            ? state.selectedNodes.filter((id) => id !== nodeId)\n            : [...state.selectedNodes, nodeId];\n          handlers.onNodeSelect?.(newSelection);\n        } else {\n          handlers.onNodeSelect?.([nodeId]);\n        }\n\n        // Start dragging\n        setDragStart({ x: clientX, y: clientY });\n        setDragOffset({ x: clientX - node.x, y: clientY - node.y });\n      }\n    },\n    [state, handlers]\n  );\n\n  // Wheel handler for zoom\n  const handleWheel = useCallback(\n    (e: React.WheelEvent) => {\n      e.preventDefault();\n\n      const delta = e.deltaY > 0 ? 0.9 : 1.1;\n      const newScale = Math.min(Math.max(state.scale * delta, 0.1), 3);\n\n      const rect = canvasRef.current?.getBoundingClientRect();\n      if (!rect) return;\n\n      // Zoom toward cursor position\n      const mouseX = e.clientX - rect.left;\n      const mouseY = e.clientY - rect.top;\n\n      const newOffset = {\n        x: mouseX - (mouseX - state.offset.x) * (newScale / state.scale),\n        y: mouseY - (mouseY - state.offset.y) * (newScale / state.scale),\n      };\n\n      handlers.onCanvasZoom?.(newScale);\n      handlers.onCanvasPan?.(newOffset);\n    },\n    [state.scale, state.offset, handlers]\n  );\n\n  // Canvas click handler\n  const handleCanvasClick = useCallback(\n    (e: MouseEvent) => {\n      if (e.target !== e.currentTarget) return;\n\n      const rect = canvasRef.current?.getBoundingClientRect();\n      if (!rect) return;\n\n      const x = (e.clientX - rect.left - state.offset.x) / state.scale;\n      const y = (e.clientY - rect.top - state.offset.y) / state.scale;\n\n      handlers.onCanvasClick?.({ x, y });\n\n      // Clear selection on canvas click\n      if (state.tool === 'select') {\n        handlers.onNodeSelect?.([]);\n      }\n    },\n    [state.offset, state.scale, state.tool, handlers]\n  );\n\n  // Get cursor style based on tool\n  const getCursor = (): string => {\n    if (isPanning) return 'grabbing';\n    switch (state.tool) {\n      case 'pan':\n        return 'grab';\n      case 'connect':\n        return 'crosshair';\n      case 'delete':\n        return 'not-allowed';\n      case 'zoom':\n        return 'zoom-in';\n      default:\n        return 'default';\n    }\n  };\n\n  return (\n    <div\n      ref={canvasRef}\n      className={`relative overflow-hidden bg-black/20 ${className}`}\n      style={{ cursor: getCursor() }}\n      onMouseDown={handleMouseDown}\n      onMouseMove={handleMouseMove}\n      onMouseUp={handleMouseUp}\n      onMouseLeave={handleMouseUp}\n      onClick={handleCanvasClick}\n      onWheel={handleWheel}\n    >\n      {/* Transformed content layer */}\n      <div\n        style={{\n          transform: `scale(${state.scale}) translate(${state.offset.x / state.scale}px, ${state.offset.y / state.scale}px)`,\n          transformOrigin: '0 0',\n          width: '100%',\n          height: '100%',\n          position: 'absolute',\n        }}\n      >\n        {/* Grid background */}\n        {state.showGrid && (\n          <svg className=\"absolute inset-0 w-full h-full pointer-events-none opacity-20\">\n            <defs>\n              <pattern\n                id=\"flow-canvas-grid\"\n                width={state.gridSize}\n                height={state.gridSize}\n                patternUnits=\"userSpaceOnUse\"\n              >\n                <path\n                  d={`M ${state.gridSize} 0 L 0 0 0 ${state.gridSize}`}\n                  fill=\"none\"\n                  stroke=\"white\"\n                  strokeWidth=\"0.5\"\n                  opacity=\"0.3\"\n                />\n              </pattern>\n            </defs>\n            <rect width=\"100%\" height=\"100%\" fill=\"url(#flow-canvas-grid)\" />\n          </svg>\n        )}\n\n        {/* SVG for connections */}\n        <svg className=\"absolute inset-0 w-full h-full pointer-events-none\">\n          <defs>\n            <marker\n              id=\"flow-canvas-arrow\"\n              markerWidth=\"8\"\n              markerHeight=\"6\"\n              refX=\"7\"\n              refY=\"3\"\n              orient=\"auto\"\n            >\n              <polygon points=\"0 0, 8 3, 0 6\" fill=\"currentColor\" className=\"text-white\" />\n            </marker>\n          </defs>\n\n          {state.connections.map((connection) => {\n            const from = getNodePosition(connection.from);\n            const to = getNodePosition(connection.to);\n            if (!from || !to) return null;\n\n            const fromX = from.x + (from.width || 240) / 2;\n            const fromY = from.y + (from.height || 60) / 2;\n            const toX = to.x + (to.width || 240) / 2;\n            const toY = to.y + (to.height || 60) / 2;\n\n            if (renderConnection) {\n              return renderConnection(connection, from, to);\n            }\n\n            return (\n              <g key={connection.id}>\n                {/* Shadow line */}\n                <line\n                  x1={fromX}\n                  y1={fromY}\n                  x2={toX}\n                  y2={toY}\n                  stroke=\"rgba(255, 255, 255, 0.1)\"\n                  strokeWidth=\"4\"\n                  strokeDasharray=\"5,5\"\n                />\n                {/* Main line */}\n                <line\n                  x1={fromX}\n                  y1={fromY}\n                  x2={toX}\n                  y2={toY}\n                  className={getConnectionColor(connection.type)}\n                  strokeWidth=\"2\"\n                  markerEnd=\"url(#flow-canvas-arrow)\"\n                />\n                {/* Label */}\n                {connection.label && (\n                  <text\n                    x={(fromX + toX) / 2}\n                    y={(fromY + toY) / 2 - 10}\n                    className=\"text-xs fill-white\"\n                    textAnchor=\"middle\"\n                  >\n                    {connection.label}\n                  </text>\n                )}\n                {connection.amount !== undefined && (\n                  <text\n                    x={(fromX + toX) / 2}\n                    y={(fromY + toY) / 2 + 5}\n                    className=\"text-xs fill-yellow-400\"\n                    textAnchor=\"middle\"\n                  >\n                    ${connection.amount.toLocaleString()}\n                  </text>\n                )}\n              </g>\n            );\n          })}\n\n          {/* Connection in progress */}\n          {state.connectingFrom && (\n            <line\n              x1={getNodePosition(state.connectingFrom)?.x || 0}\n              y1={getNodePosition(state.connectingFrom)?.y || 0}\n              x2={getNodePosition(state.connectingFrom)?.x || 0}\n              y2={getNodePosition(state.connectingFrom)?.y || 0}\n              className=\"stroke-green-400\"\n              strokeWidth=\"2\"\n              strokeDasharray=\"5,5\"\n            />\n          )}\n        </svg>\n\n        {/* Nodes */}\n        {state.nodes.map((node) => {\n          const nodeType = nodeTypes.find((n) => n.type === node.type);\n          const isSelected =\n            state.selectedNode === node.id || state.selectedNodes.includes(node.id);\n          const isDragging = state.dragging === node.id;\n          const isConnecting = state.connectingFrom === node.id;\n          const nodeColor = getNodeColor(node.type, nodeTypes);\n\n          if (renderNode) {\n            return renderNode(node, nodeType, isSelected, isDragging);\n          }\n\n          return (\n            <div\n              key={node.id}\n              className={`absolute bg-black/60 backdrop-blur-xl border rounded-xl transition-all duration-200 shadow-2xl hover:shadow-white/5 ${\n                isSelected\n                  ? 'border-blue-400/60 ring-2 ring-blue-400/30'\n                  : isConnecting\n                    ? 'ring-2 ring-green-400/50 border-green-400/60'\n                    : 'border-white/20'\n              } ${state.tool === 'delete' ? 'hover:border-red-400/60 hover:ring-2 hover:ring-red-400/30' : ''}`}\n              style={{\n                left: snapToGrid(node.x, state.gridSize, state.gridSnap),\n                top: snapToGrid(node.y, state.gridSize, state.gridSnap),\n                width: node.width || 240,\n                minHeight: node.height || 60,\n                transform: isDragging ? 'scale(1.05)' : 'scale(1)',\n                zIndex: isDragging ? 1000 : isSelected ? 100 : 10,\n                cursor:\n                  state.tool === 'select'\n                    ? 'move'\n                    : state.tool === 'connect'\n                      ? 'crosshair'\n                      : state.tool === 'delete'\n                        ? 'not-allowed'\n                        : 'pointer',\n              }}\n              onMouseDown={(e) => handleNodeMouseDown(e, node.id)}\n              onDoubleClick={() => handlers.onNodeDoubleClick?.(node)}\n            >\n              {/* Node header */}\n              <div className=\"flex items-center justify-between p-3\">\n                <div className=\"flex items-center space-x-2\">\n                  {/* Status indicator */}\n                  <div className={`w-2 h-2 rounded-full ${getStatusColor(node.status)}`} />\n                  {/* Node icon */}\n                  <div\n                    className=\"w-6 h-6 rounded-lg flex items-center justify-center\"\n                    style={{ backgroundColor: `${nodeColor}20` }}\n                  >\n                    {nodeType?.icon ? (\n                      nodeType.icon\n                    ) : (\n                      <span style={{ color: nodeColor }} className=\"text-xs font-bold\">\n                        {node.type[0].toUpperCase()}\n                      </span>\n                    )}\n                  </div>\n                </div>\n                {/* Type badge */}\n                <span\n                  className=\"text-xs px-2 py-0.5 rounded-full\"\n                  style={{ backgroundColor: `${nodeColor}20`, color: nodeColor }}\n                >\n                  {nodeType?.name || node.type}\n                </span>\n              </div>\n\n              {/* Node content */}\n              <div className=\"px-3 pb-3 space-y-1\">\n                <div className=\"text-white text-sm font-medium truncate\">{node.name}</div>\n                {node.description && (\n                  <div className=\"text-gray-400 text-xs truncate\">{node.description}</div>\n                )}\n                {/* Payment amount */}\n                {node.data?.amount != null && (\n                  <div className=\"text-yellow-400 text-sm font-medium\">\n                    ${Number(node.data.amount).toLocaleString()}\n                  </div>\n                )}\n                {/* Deadline */}\n                {node.data?.deadline != null && (\n                  <div className=\"text-gray-400 text-xs\">\n                    Due: {new Date(String(node.data.deadline)).toLocaleDateString()}\n                  </div>\n                )}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Canvas info overlay */}\n      <div className=\"absolute bottom-4 right-4 bg-black/50 backdrop-blur-sm rounded-lg px-3 py-2 text-xs text-gray-300 pointer-events-none\">\n        {state.nodes.length} nodes &bull; {state.connections.length} connections &bull;{' '}\n        {Math.round(state.scale * 100)}%\n      </div>\n    </div>\n  );\n}\n\nexport default FlowCanvas;\n"],"mappings":"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","names":[]}