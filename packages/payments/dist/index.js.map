{"version":3,"sources":["../src/index.ts"],"sourcesContent":["/**\n * @b0ase/payments\n *\n * Multi-party payment splits and revenue distribution.\n *\n * @example\n * ```typescript\n * import { PaymentSplitter, createPaymentSplit } from '@b0ase/payments';\n *\n * // Create a payment split\n * const split = createPaymentSplit({\n *   totalAmount: 1000,\n *   currency: 'USD',\n *   recipients: [\n *     { id: 'creator', address: '$creator', percent: 70 },\n *     { id: 'platform', address: '$platform', percent: 25 },\n *     { id: 'referrer', address: '$referrer', percent: 5 },\n *   ],\n * });\n *\n * console.log(split.payments);\n * // [\n * //   { recipientId: 'creator', amount: 700 },\n * //   { recipientId: 'platform', amount: 250 },\n * //   { recipientId: 'referrer', amount: 50 },\n * // ]\n * ```\n *\n * @packageDocumentation\n */\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/** Supported currencies */\nexport type Currency =\n  | 'USD'\n  | 'EUR'\n  | 'GBP'\n  | 'BTC'\n  | 'ETH'\n  | 'BSV'\n  | 'SOL'\n  | 'USDC'\n  | 'USDT';\n\n/** Payment status */\nexport type PaymentStatus =\n  | 'pending'\n  | 'processing'\n  | 'completed'\n  | 'failed'\n  | 'refunded'\n  | 'cancelled';\n\n/** Split type */\nexport type SplitType =\n  | 'percentage'  // Split by percentage\n  | 'fixed'       // Fixed amounts\n  | 'waterfall'   // Sequential (first gets X, then next, etc.)\n  | 'priority';   // Priority-based with minimums\n\n/** Payment recipient */\nexport interface Recipient {\n  /** Unique recipient ID */\n  id: string;\n  /** Payment address or handle */\n  address: string;\n  /** Display name */\n  name?: string;\n  /** Split percentage (0-100) for percentage splits */\n  percent?: number;\n  /** Fixed amount for fixed splits */\n  fixedAmount?: number;\n  /** Priority (lower = higher priority) for priority splits */\n  priority?: number;\n  /** Minimum amount (for priority splits) */\n  minimumAmount?: number;\n  /** Maximum amount cap */\n  maximumAmount?: number;\n  /** Metadata */\n  metadata?: Record<string, unknown>;\n}\n\n/** Payment split configuration */\nexport interface PaymentSplitConfig {\n  /** Total amount to split */\n  totalAmount: number;\n  /** Currency */\n  currency: Currency;\n  /** Recipients */\n  recipients: Recipient[];\n  /** Split type (default: percentage) */\n  splitType?: SplitType;\n  /** Round to decimal places (default: 2) */\n  roundTo?: number;\n  /** How to handle rounding remainder */\n  remainderTo?: string; // Recipient ID\n  /** Minimum payment threshold */\n  minimumPayment?: number;\n  /** Source/reason */\n  source?: string;\n}\n\n/** Individual payment in a split */\nexport interface SplitPayment {\n  /** Recipient ID */\n  recipientId: string;\n  /** Recipient address */\n  address: string;\n  /** Amount */\n  amount: number;\n  /** Currency */\n  currency: Currency;\n  /** Percentage of total */\n  percentOfTotal: number;\n  /** Is below minimum (skipped) */\n  belowMinimum: boolean;\n}\n\n/** Payment split result */\nexport interface PaymentSplit {\n  /** Unique split ID */\n  id: string;\n  /** Total amount */\n  totalAmount: number;\n  /** Amount distributed */\n  distributedAmount: number;\n  /** Remainder (due to rounding/minimums) */\n  remainder: number;\n  /** Currency */\n  currency: Currency;\n  /** Individual payments */\n  payments: SplitPayment[];\n  /** Recipients below minimum */\n  belowMinimumCount: number;\n  /** Split type used */\n  splitType: SplitType;\n  /** Created timestamp */\n  createdAt: Date;\n  /** Source */\n  source?: string;\n}\n\n/** Escrow configuration */\nexport interface EscrowConfig {\n  /** Total amount */\n  amount: number;\n  /** Currency */\n  currency: Currency;\n  /** Payer address */\n  payerAddress: string;\n  /** Payee address */\n  payeeAddress: string;\n  /** Release conditions */\n  releaseConditions: ReleaseCondition[];\n  /** Expiry date */\n  expiresAt?: Date;\n  /** Dispute resolution address */\n  disputeResolver?: string;\n}\n\n/** Release condition */\nexport interface ReleaseCondition {\n  /** Condition type */\n  type: 'approval' | 'milestone' | 'time' | 'signature';\n  /** Description */\n  description: string;\n  /** Required approver (for approval type) */\n  approver?: string;\n  /** Milestone ID (for milestone type) */\n  milestoneId?: string;\n  /** Release date (for time type) */\n  releaseDate?: Date;\n  /** Is met */\n  met: boolean;\n}\n\n/** Escrow state */\nexport interface Escrow {\n  /** Escrow ID */\n  id: string;\n  /** Configuration */\n  config: EscrowConfig;\n  /** Current status */\n  status: 'pending' | 'funded' | 'released' | 'refunded' | 'disputed';\n  /** Funded amount */\n  fundedAmount: number;\n  /** Released amount */\n  releasedAmount: number;\n  /** Created timestamp */\n  createdAt: Date;\n  /** Funded timestamp */\n  fundedAt?: Date;\n  /** Released timestamp */\n  releasedAt?: Date;\n}\n\n// ============================================================================\n// Payment Splitter Class\n// ============================================================================\n\n/**\n * Payment Splitter\n *\n * Calculates multi-party payment splits.\n */\nexport class PaymentSplitter {\n  private defaultCurrency: Currency = 'USD';\n  private defaultRoundTo: number = 2;\n  private defaultMinimum: number = 0.01;\n\n  constructor(options?: {\n    defaultCurrency?: Currency;\n    defaultRoundTo?: number;\n    defaultMinimum?: number;\n  }) {\n    if (options?.defaultCurrency) this.defaultCurrency = options.defaultCurrency;\n    if (options?.defaultRoundTo !== undefined) this.defaultRoundTo = options.defaultRoundTo;\n    if (options?.defaultMinimum !== undefined) this.defaultMinimum = options.defaultMinimum;\n  }\n\n  /**\n   * Generate unique ID\n   */\n  private generateId(): string {\n    return `split-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Round to decimal places\n   */\n  private round(value: number, decimals: number): number {\n    const factor = Math.pow(10, decimals);\n    return Math.round(value * factor) / factor;\n  }\n\n  /**\n   * Calculate percentage split\n   */\n  private calculatePercentageSplit(config: PaymentSplitConfig): SplitPayment[] {\n    const roundTo = config.roundTo ?? this.defaultRoundTo;\n    const minimum = config.minimumPayment ?? this.defaultMinimum;\n    const payments: SplitPayment[] = [];\n\n    // Validate percentages sum to ~100\n    const totalPercent = config.recipients.reduce(\n      (sum, r) => sum + (r.percent || 0),\n      0\n    );\n    if (Math.abs(totalPercent - 100) > 0.01) {\n      throw new Error(`Percentages must sum to 100%, got ${totalPercent}%`);\n    }\n\n    for (const recipient of config.recipients) {\n      const percent = recipient.percent || 0;\n      let amount = this.round((config.totalAmount * percent) / 100, roundTo);\n\n      // Apply caps\n      if (recipient.maximumAmount && amount > recipient.maximumAmount) {\n        amount = recipient.maximumAmount;\n      }\n\n      const belowMinimum = amount < minimum;\n\n      payments.push({\n        recipientId: recipient.id,\n        address: recipient.address,\n        amount: belowMinimum ? 0 : amount,\n        currency: config.currency,\n        percentOfTotal: percent,\n        belowMinimum,\n      });\n    }\n\n    return payments;\n  }\n\n  /**\n   * Calculate fixed split\n   */\n  private calculateFixedSplit(config: PaymentSplitConfig): SplitPayment[] {\n    const minimum = config.minimumPayment ?? this.defaultMinimum;\n    const payments: SplitPayment[] = [];\n\n    const totalFixed = config.recipients.reduce(\n      (sum, r) => sum + (r.fixedAmount || 0),\n      0\n    );\n\n    if (totalFixed > config.totalAmount) {\n      throw new Error(\n        `Fixed amounts (${totalFixed}) exceed total (${config.totalAmount})`\n      );\n    }\n\n    for (const recipient of config.recipients) {\n      const amount = recipient.fixedAmount || 0;\n      const belowMinimum = amount < minimum;\n\n      payments.push({\n        recipientId: recipient.id,\n        address: recipient.address,\n        amount: belowMinimum ? 0 : amount,\n        currency: config.currency,\n        percentOfTotal: (amount / config.totalAmount) * 100,\n        belowMinimum,\n      });\n    }\n\n    return payments;\n  }\n\n  /**\n   * Calculate waterfall split\n   */\n  private calculateWaterfallSplit(config: PaymentSplitConfig): SplitPayment[] {\n    const roundTo = config.roundTo ?? this.defaultRoundTo;\n    const minimum = config.minimumPayment ?? this.defaultMinimum;\n    const payments: SplitPayment[] = [];\n\n    // Sort by priority\n    const sorted = [...config.recipients].sort(\n      (a, b) => (a.priority || 0) - (b.priority || 0)\n    );\n\n    let remaining = config.totalAmount;\n\n    for (const recipient of sorted) {\n      if (remaining <= 0) {\n        payments.push({\n          recipientId: recipient.id,\n          address: recipient.address,\n          amount: 0,\n          currency: config.currency,\n          percentOfTotal: 0,\n          belowMinimum: true,\n        });\n        continue;\n      }\n\n      let amount = recipient.fixedAmount || remaining;\n      amount = Math.min(amount, remaining);\n\n      if (recipient.maximumAmount) {\n        amount = Math.min(amount, recipient.maximumAmount);\n      }\n\n      amount = this.round(amount, roundTo);\n      remaining -= amount;\n\n      const belowMinimum = amount < minimum;\n\n      payments.push({\n        recipientId: recipient.id,\n        address: recipient.address,\n        amount: belowMinimum ? 0 : amount,\n        currency: config.currency,\n        percentOfTotal: (amount / config.totalAmount) * 100,\n        belowMinimum,\n      });\n    }\n\n    return payments;\n  }\n\n  /**\n   * Create payment split\n   */\n  split(config: PaymentSplitConfig): PaymentSplit {\n    const splitType = config.splitType || 'percentage';\n    let payments: SplitPayment[];\n\n    switch (splitType) {\n      case 'percentage':\n        payments = this.calculatePercentageSplit(config);\n        break;\n      case 'fixed':\n        payments = this.calculateFixedSplit(config);\n        break;\n      case 'waterfall':\n      case 'priority':\n        payments = this.calculateWaterfallSplit(config);\n        break;\n      default:\n        throw new Error(`Unknown split type: ${splitType}`);\n    }\n\n    const distributedAmount = payments.reduce((sum, p) => sum + p.amount, 0);\n    const remainder = this.round(\n      config.totalAmount - distributedAmount,\n      config.roundTo ?? this.defaultRoundTo\n    );\n\n    // Handle remainder\n    if (remainder > 0 && config.remainderTo) {\n      const remainderPayment = payments.find(\n        (p) => p.recipientId === config.remainderTo\n      );\n      if (remainderPayment) {\n        remainderPayment.amount += remainder;\n      }\n    }\n\n    return {\n      id: this.generateId(),\n      totalAmount: config.totalAmount,\n      distributedAmount: distributedAmount + (config.remainderTo ? remainder : 0),\n      remainder: config.remainderTo ? 0 : remainder,\n      currency: config.currency,\n      payments,\n      belowMinimumCount: payments.filter((p) => p.belowMinimum).length,\n      splitType,\n      createdAt: new Date(),\n      source: config.source,\n    };\n  }\n\n  /**\n   * Validate split configuration\n   */\n  validate(config: PaymentSplitConfig): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    if (config.totalAmount <= 0) {\n      errors.push('Total amount must be positive');\n    }\n\n    if (config.recipients.length === 0) {\n      errors.push('At least one recipient required');\n    }\n\n    const splitType = config.splitType || 'percentage';\n\n    if (splitType === 'percentage') {\n      const totalPercent = config.recipients.reduce(\n        (sum, r) => sum + (r.percent || 0),\n        0\n      );\n      if (Math.abs(totalPercent - 100) > 0.01) {\n        errors.push(`Percentages must sum to 100%, got ${totalPercent}%`);\n      }\n    }\n\n    if (splitType === 'fixed') {\n      const totalFixed = config.recipients.reduce(\n        (sum, r) => sum + (r.fixedAmount || 0),\n        0\n      );\n      if (totalFixed > config.totalAmount) {\n        errors.push(\n          `Fixed amounts (${totalFixed}) exceed total (${config.totalAmount})`\n        );\n      }\n    }\n\n    // Check for duplicate IDs\n    const ids = config.recipients.map((r) => r.id);\n    const duplicates = ids.filter((id, i) => ids.indexOf(id) !== i);\n    if (duplicates.length > 0) {\n      errors.push(`Duplicate recipient IDs: ${duplicates.join(', ')}`);\n    }\n\n    return { valid: errors.length === 0, errors };\n  }\n}\n\n// ============================================================================\n// Factory Functions\n// ============================================================================\n\n/**\n * Create a payment splitter\n */\nexport function createPaymentSplitter(options?: {\n  defaultCurrency?: Currency;\n  defaultRoundTo?: number;\n  defaultMinimum?: number;\n}): PaymentSplitter {\n  return new PaymentSplitter(options);\n}\n\n/**\n * Quick split without creating splitter instance\n */\nexport function createPaymentSplit(config: PaymentSplitConfig): PaymentSplit {\n  const splitter = new PaymentSplitter();\n  return splitter.split(config);\n}\n\n// ============================================================================\n// Preset Splits\n// ============================================================================\n\n/** Standard 70/30 creator/platform split */\nexport function creatorPlatformSplit(\n  totalAmount: number,\n  creatorAddress: string,\n  platformAddress: string,\n  currency: Currency = 'USD'\n): PaymentSplit {\n  return createPaymentSplit({\n    totalAmount,\n    currency,\n    recipients: [\n      { id: 'creator', address: creatorAddress, percent: 70 },\n      { id: 'platform', address: platformAddress, percent: 30 },\n    ],\n  });\n}\n\n/** Three-way split (creator/platform/referrer) */\nexport function threeWaySplit(\n  totalAmount: number,\n  addresses: {\n    creator: string;\n    platform: string;\n    referrer: string;\n  },\n  percentages: {\n    creator: number;\n    platform: number;\n    referrer: number;\n  } = { creator: 70, platform: 25, referrer: 5 },\n  currency: Currency = 'USD'\n): PaymentSplit {\n  return createPaymentSplit({\n    totalAmount,\n    currency,\n    recipients: [\n      { id: 'creator', address: addresses.creator, percent: percentages.creator },\n      { id: 'platform', address: addresses.platform, percent: percentages.platform },\n      { id: 'referrer', address: addresses.referrer, percent: percentages.referrer },\n    ],\n  });\n}\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\n/**\n * Format currency amount\n */\nexport function formatAmount(\n  amount: number,\n  currency: Currency\n): string {\n  const symbols: Record<string, string> = {\n    USD: '$',\n    EUR: '€',\n    GBP: '£',\n    BTC: '₿',\n    ETH: 'Ξ',\n    BSV: 'BSV ',\n    SOL: 'SOL ',\n    USDC: 'USDC ',\n    USDT: 'USDT ',\n  };\n\n  const decimals = ['BTC', 'ETH', 'BSV', 'SOL'].includes(currency) ? 8 : 2;\n  const symbol = symbols[currency] || `${currency} `;\n\n  return `${symbol}${amount.toFixed(decimals)}`;\n}\n\n/**\n * Calculate platform fee\n */\nexport function calculatePlatformFee(\n  amount: number,\n  feePercent: number,\n  minFee: number = 0\n): number {\n  const fee = amount * (feePercent / 100);\n  return Math.max(fee, minFee);\n}\n"],"mappings":"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","names":[]}