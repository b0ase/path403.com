{"version":3,"sources":["../src/index.ts"],"sourcesContent":["/**\n * @b0ase/wallet-view\n *\n * Unified wallet balance display types and utilities.\n *\n * @example\n * ```typescript\n * import {\n *   WalletBalance,\n *   formatBalance,\n *   aggregateBalances,\n *   calculatePortfolioValue,\n * } from '@b0ase/wallet-view';\n *\n * const balances: WalletBalance[] = [\n *   { chain: 'bsv', symbol: 'BSV', balance: 1.5, usdValue: 75 },\n *   { chain: 'ethereum', symbol: 'ETH', balance: 0.5, usdValue: 1250 },\n * ];\n *\n * const total = calculatePortfolioValue(balances);\n * console.log(`Total: $${total}`); // Total: $1325\n * ```\n *\n * @packageDocumentation\n */\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/** Blockchain/chain type */\nexport type Chain =\n  | 'bsv'\n  | 'bitcoin'\n  | 'ethereum'\n  | 'solana'\n  | 'polygon'\n  | 'arbitrum'\n  | 'base'\n  | 'avalanche';\n\n/** Asset type */\nexport type AssetType =\n  | 'native'     // Native coin (BSV, ETH, SOL)\n  | 'token'      // Fungible token (ERC-20, SPL, BSV-20)\n  | 'nft'        // Non-fungible token\n  | 'ordinal';   // Bitcoin ordinal/inscription\n\n/** Balance status */\nexport type BalanceStatus = 'confirmed' | 'pending' | 'unconfirmed';\n\n/** Wallet balance */\nexport interface WalletBalance {\n  /** Chain */\n  chain: Chain;\n  /** Token/asset symbol */\n  symbol: string;\n  /** Token name */\n  name?: string;\n  /** Balance amount */\n  balance: number;\n  /** Decimal places */\n  decimals?: number;\n  /** USD value */\n  usdValue?: number;\n  /** Asset type */\n  assetType?: AssetType;\n  /** Contract address (for tokens) */\n  contractAddress?: string;\n  /** Token logo URL */\n  logoUrl?: string;\n  /** Balance status */\n  status?: BalanceStatus;\n  /** Last updated */\n  updatedAt?: Date;\n}\n\n/** UTXO (Unspent Transaction Output) */\nexport interface UTXO {\n  /** Transaction ID */\n  txid: string;\n  /** Output index */\n  vout: number;\n  /** Amount in satoshis */\n  satoshis: number;\n  /** Script (hex) */\n  script?: string;\n  /** Is confirmed */\n  confirmed: boolean;\n  /** Block height */\n  blockHeight?: number;\n  /** Confirmations */\n  confirmations?: number;\n}\n\n/** Token holding */\nexport interface TokenHolding {\n  /** Token symbol */\n  symbol: string;\n  /** Token name */\n  name: string;\n  /** Balance */\n  balance: bigint;\n  /** Decimals */\n  decimals: number;\n  /** Contract address */\n  contractAddress?: string;\n  /** Token standard */\n  standard?: 'bsv-20' | 'erc-20' | 'erc-721' | 'erc-1155' | 'spl';\n  /** Logo URL */\n  logoUrl?: string;\n  /** USD price per token */\n  priceUsd?: number;\n  /** Total USD value */\n  valueUsd?: number;\n}\n\n/** NFT/Ordinal holding */\nexport interface NFTHolding {\n  /** Collection name */\n  collection?: string;\n  /** Token ID */\n  tokenId: string;\n  /** Name */\n  name?: string;\n  /** Description */\n  description?: string;\n  /** Image URL */\n  imageUrl?: string;\n  /** Content type */\n  contentType?: string;\n  /** Inscription ID (for ordinals) */\n  inscriptionId?: string;\n  /** Floor price */\n  floorPriceUsd?: number;\n  /** Chain */\n  chain: Chain;\n}\n\n/** Wallet summary */\nexport interface WalletSummary {\n  /** Total USD value */\n  totalValueUsd: number;\n  /** Native coin balances */\n  nativeBalances: WalletBalance[];\n  /** Token holdings */\n  tokens: TokenHolding[];\n  /** NFT count */\n  nftCount: number;\n  /** Chains with balances */\n  activeChains: Chain[];\n  /** Last updated */\n  updatedAt: Date;\n}\n\n/** Portfolio allocation */\nexport interface PortfolioAllocation {\n  /** Asset symbol */\n  symbol: string;\n  /** Chain */\n  chain: Chain;\n  /** USD value */\n  valueUsd: number;\n  /** Percentage of portfolio */\n  percentage: number;\n  /** Asset type */\n  assetType: AssetType;\n}\n\n// ============================================================================\n// Constants\n// ============================================================================\n\n/** Chain display names */\nexport const CHAIN_NAMES: Record<Chain, string> = {\n  bsv: 'Bitcoin SV',\n  bitcoin: 'Bitcoin',\n  ethereum: 'Ethereum',\n  solana: 'Solana',\n  polygon: 'Polygon',\n  arbitrum: 'Arbitrum',\n  base: 'Base',\n  avalanche: 'Avalanche',\n};\n\n/** Chain native symbols */\nexport const CHAIN_SYMBOLS: Record<Chain, string> = {\n  bsv: 'BSV',\n  bitcoin: 'BTC',\n  ethereum: 'ETH',\n  solana: 'SOL',\n  polygon: 'MATIC',\n  arbitrum: 'ETH',\n  base: 'ETH',\n  avalanche: 'AVAX',\n};\n\n/** Chain explorers */\nexport const CHAIN_EXPLORERS: Record<Chain, string> = {\n  bsv: 'https://whatsonchain.com',\n  bitcoin: 'https://mempool.space',\n  ethereum: 'https://etherscan.io',\n  solana: 'https://solscan.io',\n  polygon: 'https://polygonscan.com',\n  arbitrum: 'https://arbiscan.io',\n  base: 'https://basescan.org',\n  avalanche: 'https://snowtrace.io',\n};\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\n/**\n * Format balance for display\n */\nexport function formatBalance(\n  balance: number,\n  decimals: number = 8,\n  options?: { maxDecimals?: number; compact?: boolean }\n): string {\n  const maxDecimals = options?.maxDecimals ?? decimals;\n\n  if (options?.compact && balance >= 1000000) {\n    return `${(balance / 1000000).toFixed(2)}M`;\n  }\n  if (options?.compact && balance >= 1000) {\n    return `${(balance / 1000).toFixed(2)}K`;\n  }\n\n  // Determine significant decimals\n  let displayDecimals = maxDecimals;\n  if (balance >= 1000) displayDecimals = Math.min(2, maxDecimals);\n  else if (balance >= 1) displayDecimals = Math.min(4, maxDecimals);\n  else if (balance >= 0.0001) displayDecimals = Math.min(6, maxDecimals);\n\n  return balance.toFixed(displayDecimals);\n}\n\n/**\n * Format USD value\n */\nexport function formatUsdValue(value: number): string {\n  if (value >= 1000000) {\n    return `$${(value / 1000000).toFixed(2)}M`;\n  }\n  if (value >= 1000) {\n    return `$${(value / 1000).toFixed(2)}K`;\n  }\n  return `$${value.toFixed(2)}`;\n}\n\n/**\n * Calculate total portfolio value\n */\nexport function calculatePortfolioValue(balances: WalletBalance[]): number {\n  return balances.reduce((sum, b) => sum + (b.usdValue || 0), 0);\n}\n\n/**\n * Aggregate balances by symbol\n */\nexport function aggregateBalances(\n  balances: WalletBalance[]\n): Map<string, WalletBalance> {\n  const aggregated = new Map<string, WalletBalance>();\n\n  for (const balance of balances) {\n    const key = `${balance.chain}:${balance.symbol}`;\n    const existing = aggregated.get(key);\n\n    if (existing) {\n      existing.balance += balance.balance;\n      existing.usdValue = (existing.usdValue || 0) + (balance.usdValue || 0);\n    } else {\n      aggregated.set(key, { ...balance });\n    }\n  }\n\n  return aggregated;\n}\n\n/**\n * Calculate portfolio allocation\n */\nexport function calculateAllocation(\n  balances: WalletBalance[]\n): PortfolioAllocation[] {\n  const totalValue = calculatePortfolioValue(balances);\n  if (totalValue === 0) return [];\n\n  return balances\n    .filter((b) => b.usdValue && b.usdValue > 0)\n    .map((b) => ({\n      symbol: b.symbol,\n      chain: b.chain,\n      valueUsd: b.usdValue!,\n      percentage: (b.usdValue! / totalValue) * 100,\n      assetType: b.assetType || 'native',\n    }))\n    .sort((a, b) => b.valueUsd - a.valueUsd);\n}\n\n/**\n * Create wallet summary\n */\nexport function createWalletSummary(\n  balances: WalletBalance[],\n  tokens: TokenHolding[] = [],\n  nftCount: number = 0\n): WalletSummary {\n  const nativeBalances = balances.filter(\n    (b) => !b.assetType || b.assetType === 'native'\n  );\n  const activeChains = [...new Set(balances.map((b) => b.chain))];\n\n  return {\n    totalValueUsd: calculatePortfolioValue(balances),\n    nativeBalances,\n    tokens,\n    nftCount,\n    activeChains,\n    updatedAt: new Date(),\n  };\n}\n\n/**\n * Convert satoshis to BSV\n */\nexport function satsToBsv(sats: number): number {\n  return sats / 100000000;\n}\n\n/**\n * Convert BSV to satoshis\n */\nexport function bsvToSats(bsv: number): number {\n  return Math.round(bsv * 100000000);\n}\n\n/**\n * Convert wei to ETH\n */\nexport function weiToEth(wei: bigint): number {\n  return Number(wei) / 1e18;\n}\n\n/**\n * Convert ETH to wei\n */\nexport function ethToWei(eth: number): bigint {\n  return BigInt(Math.round(eth * 1e18));\n}\n\n/**\n * Convert lamports to SOL\n */\nexport function lamportsToSol(lamports: number): number {\n  return lamports / 1e9;\n}\n\n/**\n * Convert SOL to lamports\n */\nexport function solToLamports(sol: number): number {\n  return Math.round(sol * 1e9);\n}\n\n/**\n * Get explorer URL for address\n */\nexport function getAddressExplorerUrl(chain: Chain, address: string): string {\n  const base = CHAIN_EXPLORERS[chain];\n  switch (chain) {\n    case 'bsv':\n      return `${base}/address/${address}`;\n    case 'bitcoin':\n      return `${base}/address/${address}`;\n    case 'ethereum':\n    case 'polygon':\n    case 'arbitrum':\n    case 'base':\n    case 'avalanche':\n      return `${base}/address/${address}`;\n    case 'solana':\n      return `${base}/account/${address}`;\n    default:\n      return `${base}/address/${address}`;\n  }\n}\n\n/**\n * Get explorer URL for transaction\n */\nexport function getTxExplorerUrl(chain: Chain, txid: string): string {\n  const base = CHAIN_EXPLORERS[chain];\n  switch (chain) {\n    case 'bsv':\n      return `${base}/tx/${txid}`;\n    case 'bitcoin':\n      return `${base}/tx/${txid}`;\n    case 'ethereum':\n    case 'polygon':\n    case 'arbitrum':\n    case 'base':\n    case 'avalanche':\n      return `${base}/tx/${txid}`;\n    case 'solana':\n      return `${base}/tx/${txid}`;\n    default:\n      return `${base}/tx/${txid}`;\n  }\n}\n"],"mappings":"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","names":[]}