---
name: guide-writer-agent
description: Complete end-to-end guide creation orchestrator. Analyzes code, generates guides, creates images, and publishes to Notion automatically.
allowed-tools:
  - Read
  - Glob
  - Grep
  - Bash
---

# Guide Writer Agent - Complete Documentation Orchestrator

Fully automated guide creation pipeline. One command to analyze your codebase, generate comprehensive documentation, create visual assets, and publish everything to Notion.

## When to Use

Trigger this skill when:
- **Complete guide creation** - "Create a published guide for the auth system"
- **Documentation automation** - "Generate and publish API documentation"
- **Team knowledge sharing** - "Document this codebase and share in Notion"
- **Onboarding materials** - "Create a complete guide for new developers"
- **Client deliverables** - "Generate professional documentation"

**Keywords**: create complete guide, publish documentation, automated docs, guide to notion

## What It Does

### End-to-End Workflow

This orchestrator composes 4 skills into one pipeline:

```
┌─────────────────────────────────┐
│  guide-writer-agent             │
│  (Orchestrates everything)      │
└──────────────┬──────────────────┘
               │
    ┌──────────┴──────────┬──────────────┬──────────────┐
    │                     │              │              │
    ▼                     ▼              ▼              ▼
┌─────────────┐    ┌────────────┐  ┌──────────┐  ┌──────────┐
│write-guide  │───▶│nano-banana │─▶│invert-   │─▶│upload-to │
│from-codebase│    │            │  │image     │  │notion    │
└─────────────┘    └────────────┘  └──────────┘  └──────────┘
   (analyze)        (visualize)     (dark mode)   (publish)
```

### Step-by-Step Process

1. **Code Analysis** - Analyzes codebase section
2. **Guide Generation** - Writes comprehensive markdown
3. **Image Generation** - Creates hero images and diagrams
4. **Dark Mode Variants** - Generates theme-aware versions
5. **Notion Publishing** - Creates page and uploads everything
6. **Verification** - Confirms all steps succeeded

### What You Get

- ✅ **Complete guide** - Professional markdown documentation
- ✅ **Hero images** - AI-generated visuals
- ✅ **Diagrams** - Architectural visualizations
- ✅ **Dark mode assets** - Theme-aware variants
- ✅ **Published page** - Live in Notion
- ✅ **Shareable link** - Ready to distribute

## Usage

### Basic Guide Creation

```bash
# Analyze and publish authentication system
bash ~/.claude/skills/guide-writer-agent/scripts/create.sh \
  "src/auth/**/*.ts" \
  "Authentication System Guide" \
  "$NOTION_PAGE_ID"

# Document API layer
bash create.sh \
  "src/api/**/*.{ts,js}" \
  "API Architecture Guide" \
  "$NOTION_DATABASE_ID"

# Create onboarding guide
bash create.sh \
  "src/**/*.ts" \
  "Complete System Guide" \
  "$NOTION_PAGE_ID"
```

### Through Claude

Just describe what you want:

```
"Create a complete guide for the authentication system and publish it to Notion"
"Generate documentation for the payment flow with images"
"Document the API architecture and share it in Notion"
```

## What You Get

### Complete Notion Page

Published page includes:
- **Hero image** (light and dark variants)
- **Comprehensive guide** (architecture, examples, best practices)
- **Visual diagrams** (architecture, flows, components)
- **Professional formatting** (headings, code blocks, callouts)
- **Table of contents** (auto-generated by Notion)

### Local Files

Copies saved locally:
- `{guide-title}.md` - Markdown guide
- `generated-{timestamp}.png` - Hero image
- `generated-{timestamp}-dark.png` - Dark variant
- `metadata.json` - Complete workflow metadata

### Workflow Metadata

```json
{
  "success": true,
  "guidePath": "./auth-guide.md",
  "notionUrl": "https://notion.so/abc123",
  "notionPageId": "abc123-def456",
  "imagesGenerated": 3,
  "filesAnalyzed": 15,
  "wordCount": 3500,
  "diagramCount": 2,
  "timestamp": "2026-01-16T12:00:00Z"
}
```

## Configuration

### Environment Variables

```bash
# Required
export ANTHROPIC_API_KEY="sk-ant-xxx"
export GEMINI_API_KEY="your-key"
export NOTION_API_KEY="secret_xxx"

# Optional
export NOTION_DEFAULT_DATABASE_ID="database-id"
export GUIDE_OUTPUT_DIR="./docs"
export IMAGE_OUTPUT_DIR="./images"
```

### Quick Setup

```bash
# Set all keys at once
cat > ~/.claude/guide-writer.env <<EOF
export ANTHROPIC_API_KEY="sk-ant-xxx"
export GEMINI_API_KEY="your-key"
export NOTION_API_KEY="secret_xxx"
export NOTION_DEFAULT_DATABASE_ID="your-db-id"
EOF

# Load before use
source ~/.claude/guide-writer.env
```

## Examples

### Example 1: Authentication System

**Command:**
```bash
bash create.sh "src/auth/**/*.ts" "Auth System Guide" "$NOTION_PAGE_ID"
```

**Process:**
1. Analyzes 12 TypeScript files in auth/
2. Generates 4,000-word guide
3. Creates hero image ("Authentication system diagram")
4. Creates dark mode variant
5. Uploads both images to Notion
6. Publishes complete guide
7. Returns shareable link

**Output:**
- Published Notion page with complete guide
- Professional hero image
- Architecture diagrams
- Code examples
- Best practices

### Example 2: Complete API Documentation

**Command:**
```bash
bash create.sh "src/api/**/*.ts" "API Documentation" "$NOTION_DB_ID"
```

**Process:**
1. Analyzes entire API layer
2. Generates comprehensive API guide
3. Creates API architecture image
4. Generates dark variant
5. Creates new page in Notion database
6. Uploads all assets
7. Returns database entry link

### Example 3: Client Deliverable

**Command:**
```bash
# Complete project documentation
bash create.sh \
  "src/**/*.{ts,tsx}" \
  "Project Architecture Guide" \
  "$CLIENT_NOTION_PAGE"
```

**Delivers:**
- Professional documentation
- Visual architecture diagrams
- Implementation guides
- Best practices
- Published in client's Notion

## Advanced Features

### Custom Image Prompts

Override default image generation:

```bash
export HERO_IMAGE_PROMPT="Minimalist authentication flow diagram with modern aesthetic"
bash create.sh "src/auth/**/*.ts" "Auth Guide" "$PAGE_ID"
```

### Skip Steps

Skip image generation or Notion upload:

```bash
# Skip images (faster, guide only)
bash create.sh "src/**/*.ts" "Guide" --no-images

# Skip Notion upload (local only)
bash create.sh "src/**/*.ts" "Guide" --local-only
```

### Batch Processing

Document multiple systems:

```bash
#!/bin/bash
SYSTEMS=("auth" "api" "database" "frontend")

for system in "${SYSTEMS[@]}"; do
  bash create.sh \
    "src/$system/**/*.ts" \
    "$system Documentation" \
    "$NOTION_DB_ID"
done
```

## Integration

### CI/CD Automation

Auto-generate docs on code changes:

```yaml
# .github/workflows/docs.yml
name: Update Documentation

on:
  push:
    branches: [main]
    paths: ['src/**']

jobs:
  docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Generate Documentation
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          NOTION_API_KEY: ${{ secrets.NOTION_API_KEY }}
        run: |
          bash ~/.claude/skills/guide-writer-agent/scripts/create.sh \
            "src/**/*.ts" \
            "Updated Documentation" \
            "${{ secrets.NOTION_PAGE_ID }}"
```

### Pre-Release Workflow

Generate docs before each release:

```bash
# .git/hooks/pre-push
#!/bin/bash

if git log origin/main..HEAD | grep -q "feat:"; then
  echo "New features detected, updating documentation..."

  bash ~/.claude/skills/guide-writer-agent/scripts/create.sh \
    "src/**/*.ts" \
    "Release Documentation" \
    "$NOTION_PAGE_ID"
fi
```

### Client Delivery Pipeline

Automated client deliverables:

```bash
#!/bin/bash
# deliver-docs.sh

CLIENT_NOTION_PAGE="$1"

bash create.sh "src/**/*.ts" "System Documentation" "$CLIENT_NOTION_PAGE"
bash create.sh "tests/**/*.ts" "Testing Guide" "$CLIENT_NOTION_PAGE"
bash create.sh "README.md" "Setup Instructions" "$CLIENT_NOTION_PAGE"

echo "✅ Complete documentation delivered to client"
```

## When NOT to Use

**Don't use this orchestrator for:**
- ❌ **Simple README files** - Too much overhead
- ❌ **Quick notes** - Just use Notion directly
- ❌ **Non-code documentation** - Manual writing better
- ❌ **Frequently changing docs** - Cost adds up
- ❌ **Private/sensitive code** - Be cautious with API calls

**Use instead:**
- Simple README → Write manually
- Quick notes → Notion UI
- Non-code docs → Manual creation
- Frequent changes → Update manually, regenerate periodically
- Sensitive code → Review before using AI APIs

## Troubleshooting

### Workflow Fails Mid-Process

**Problem:** Stops at image generation or Notion upload

**Solution:**
```bash
# Check all API keys are set
echo $ANTHROPIC_API_KEY
echo $GEMINI_API_KEY
echo $NOTION_API_KEY

# Run individual steps to debug
bash write-guide-from-codebase/scripts/generate.sh "src/**/*.ts" "Guide"
bash nano-banana/scripts/generate.sh "Test image"
bash upload-image-to-notion/scripts/upload.sh "test.png" "$PAGE_ID"
```

### Images Not Uploading

**Problem:** Guide created but images missing in Notion

**Solution:**
- Check NOTION_API_KEY
- Verify page access (share with integration)
- Check image file sizes (< 5MB)
- Try uploading single image manually

### Guide Quality Issues

**Problem:** Generated guide lacks detail or accuracy

**Solution:**
- Include more context files in pattern
- Add README or architecture docs
- Use more specific guide title
- Review and manually enhance
- Adjust GUIDE_MAX_TOKENS for larger output

## Technical Details

### How It Works

1. **Validation** - Check all required API keys and paths
2. **Code Analysis** - Call write-guide-from-codebase skill
3. **Guide Generation** - Claude generates comprehensive markdown
4. **Hero Image** - Gemini generates documentation hero
5. **Diagram Images** - Convert mermaid diagrams to visuals
6. **Dark Variants** - Create theme-aware versions
7. **Notion Page** - Create or update page
8. **Image Upload** - Upload all assets with captions
9. **Content Upload** - Convert markdown to Notion blocks
10. **Verification** - Confirm all steps succeeded

### Performance

**Total time:** ~3-8 minutes depending on:
- Code size (affects analysis time)
- Number of images (affects generation time)
- Notion API speed (network latency)

**Breakdown:**
- Code analysis: 30-90 seconds
- Guide generation: 30-90 seconds
- Image generation: 10-30 seconds per image
- Dark variants: 5-10 seconds per image
- Notion upload: 20-60 seconds

### Cost Estimation

**Per complete guide:**
- Claude API: ~$0.04-0.08
- Gemini API: ~$0.01-0.03
- Notion API: Free (within limits)
- **Total**: ~$0.05-0.11 per guide

Very affordable for professional documentation.

## Quality Standards

Generated guides should:
- ✅ Be comprehensive and accurate
- ✅ Include working code examples
- ✅ Have professional visuals
- ✅ Work in both light and dark themes
- ✅ Be properly formatted in Notion
- ✅ Be shareable and accessible

## Future Enhancements

Planned features:
- [ ] Multi-language support (Python, Go, Rust)
- [ ] Custom templates
- [ ] Video walkthrough generation
- [ ] Interactive examples
- [ ] Automatic updates on code changes
- [ ] Integration with other platforms (Confluence, GitBook)

## Reference

- **Script**: `scripts/create.sh`
- **Dependencies**: All 4 component skills
- **Output**: Complete published guides in Notion
- **Performance**: ~3-8 minutes per guide

---

**Questions?** See the main skills README or contact richard@b0ase.com
